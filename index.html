<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Precios</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 50px;
        }
        .container {
            max-width: 400px;
            margin: auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            box-shadow: 2px 2px 10px rgba(0,0,0,0.1);
        }
        select, input, button {
            width: 95%;
            margin: 10px 0;
            padding: 10px;
        }
        .cart-item {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }
        #invoice {
            display: none;
            margin-top: 20px;
        }
        #calculator {
            display: block;
        }
        .invoice-total {
            font-weight: bold;
            font-size: 1.2em;
            margin-top: 20px;
            text-align: right;
        }
        .invoice-button {
            margin-top: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        @media print {
            .no-print {
                display: none;
            }
            body {
                font-family: 'Arial', sans-serif;
            }
        }
    </style>
</head>
<body>
    <div id="calculator" class="container">
        <h2>Calculadora de Precios</h2>
        <p id="dollarRate">Cargando tasa del dólar BCV...</p>
        <label for="category">Categoría:</label>
        <select id="category" onchange="filterProducts()">
            <option value="Condimentos semi">Condimentos semi</option>
            <option value="Condimentos Puros">Condimentos puros</option>
            <option value="Hierbas e Infusiones">Hierbas e Infusiones</option>
            <option value="Semillas">Semillas</option>
            <option value="Maniseria">Maniseria</option>
            <option value="Turrones">Turrones</option>
            <option value="Granos">Granos</option>
            <option value="Químicos">Químicos</option>
            <option value="Esencias">Esencias</option>
            <option value="Bolsas">Bolsas</option>
            <option value="Animales">Animales</option>
            <option value="Colores">Colores</option>
            <option value="Repostería">Repostería</option>
        </select>
        <label for="product">Producto:</label>
        <select id="product" disabled>
            <option value="4.20" data-category="Condimentos semi">Aliño semi</option>
        <option value="2.88" data-category="Condimentos semi">Adobo semi</option>
        <option value="4.12" data-category="Condimentos semi">Carmencita</option>
        <option value="2.58" data-category="Condimentos semi">Cubito semi</option>
        <option value="6.04" data-category="Condimentos semi">Pimienta semi</option>
        <option value="3.60" data-category="Condimentos semi">Curry semi</option>
        <option value="4.60" data-category="Condimentos semi">Ajo semi</option>
        <option value="8.64" data-category="Condimentos semi">Comino semi</option>
        <option value="4.32" data-category="Condimentos semi">Sabroceador semi</option>
        <option value="8.80" data-category="Condimentos semi">Orégano Molido</option>
        <option value="7.00" data-category="Condimentos semi">Orégano Entero</option>
        <option value="4.60" data-category="Condimentos semi">Combinaditos</option>

        <option value="7.30" data-category="Condimentos Puros">Aliño</option>
        <option value="7.00" data-category="Condimentos Puros">Cubito</option>
        <option value="6.48" data-category="Condimentos Puros">Adobo</option>
        <option value="5.30" data-category="Condimentos Puros">Ajo Mix</option>
        <option value="18.00" data-category="Condimentos Puros">Ajo Granulado</option>
        <option value="17.04" data-category="Condimentos Puros">Cebolla</option>
        <option value="12.00" data-category="Condimentos Puros">Cúrcuma</option>
        <option value="7.56" data-category="Condimentos Puros">Jengibre</option>
        <option value="15.04" data-category="Condimentos Puros">Paprika Dulce</option>
        <option value="13.04" data-category="Condimentos Puros">Paprika Picante</option>
        <option value="20.00" data-category="Condimentos Puros">Comino</option>
        <option value="11.04" data-category="Condimentos Puros">Curry</option>
        <option value="26.00" data-category="Condimentos Puros">Pimienta</option>
        <option value="5.94" data-category="Condimentos Puros">Trifogón</option>
        <option value="40.00" data-category="Condimentos Puros">7 Especies</option>
        <option value="5.94" data-category="Condimentos Puros">Salchina</option>
        <option value="8.50" data-category="Condimentos Puros">Ajo Entero</option>

        <option value="18.00" data-category="Hierbas e Infusiones">Flor de Jamaica</option>
        <option value="21.67" data-category="Hierbas e Infusiones">Manzanilla</option>
        <option value="22.00" data-category="Hierbas e Infusiones">Té Verde</option>
        <option value="15.04" data-category="Hierbas e Infusiones">Hierbabuena</option>
        <option value="22.00" data-category="Hierbas e Infusiones">Té Negro</option>
        <option value="14.00" data-category="Hierbas e Infusiones">Sen</option>
        <option value="13.60" data-category="Hierbas e Infusiones">Tomillo</option>
        <option value="11.04" data-category="Hierbas e Infusiones">Menta</option>
        <option value="15.00" data-category="Hierbas e Infusiones">Laurel</option>
        <option value="13.60" data-category="Hierbas e Infusiones">Romero</option>
        <option value="14.00" data-category="Hierbas e Infusiones">Albahaca</option>
        <option value="19.44" data-category="Hierbas e Infusiones">Stevia</option>
        <option value="39.00" data-category="Hierbas e Infusiones">Clavitos</option>
        <option value="25.00" data-category="Hierbas e Infusiones">Canela Entera</option>
        <option value="27.00" data-category="Hierbas e Infusiones">Canela Molida</option>
        <option value="28.00" data-category="Hierbas e Infusiones">Anís Estrellado</option>
        <option value="19.66" data-category="Hierbas e Infusiones">Malagueta</option>
        <option value="9.28" data-category="Hierbas e Infusiones">Perejil</option>
        <option value="55.00" data-category="Hierbas e Infusiones">Tilo</option>
        <option value="7.2" data-category="Hierbas e Infusiones">Vinagre de manzana</option>
        <option value="28.08" data-category="Hierbas e Infusiones">Aceite de coco</option>
        <option value="7.13" data-category="Hierbas e Infusiones">Aceite de oliva</option>
        <option value="36.00" data-category="Hierbas e Infusiones">nuez moscada</option>
        <option value="0.75" data-category="Hierbas e Infusiones">Panela</option>


        <option value="18.40" data-category="Semillas">Chía</option>
        <option value="14.20" data-category="Semillas">Anís Dulce</option>
        <option value="4.24" data-category="Semillas">Linaza</option>
        <option value="5.60" data-category="Semillas">Girasol</option>
        <option value="5.40" data-category="Semillas">Auyama</option>
        <option value="4.32" data-category="Semillas">Patilla</option>
        <option value="7.23" data-category="Semillas">Fenogreco</option>
        <option value="4.86" data-category="Semillas">Ajonjolí Natural</option>
        <option value="12.00" data-category="Semillas">Ajonjolí Blanco</option>
        <option value="16.00" data-category="Semillas">Ajonjolí Negro</option>
        <option value="18.00" data-category="Semillas">Comino Entero</option>
        <option value="24.00" data-category="Semillas">Pimienta Negra</option>
        <option value="40.00" data-category="Semillas">Pimienta Blanca</option>
        <option value="50.00" data-category="Semillas">Pimienta Roja</option>
        <option value="14.00" data-category="Semillas">Hinojo</option>
        <option value="13.04" data-category="Semillas">Quinoa</option>
        <option value="7.04" data-category="Semillas">Mostaza</option>
        <option value="14.00" data-category="Semillas">Cilantro</option>
        <option value="5.55" data-category="Semillas">Cebada</option>
        <option value="10.74" data-category="Semillas">Aceitunas</option>
        <option value="7.50" data-category="Semillas">Alcaparras</option>
        <option value="5.18" data-category="Semillas">Trigo Fino</option>
        <option value="2.70" data-category="Semillas">Avena</option>
        <option value="2.70" data-category="Semillas">Afrecho</option>
        <option value="17.50" data-category="Semillas">Achote</option>
        <option value="0.50" data-category="Semillas">Sal de Mesa</option>
        <option value="8.60" data-category="Semillas">Pasas</option>
        <option value="13.80" data-category="Semillas">Ciruela Pasas</option>
        <option value="10.00" data-category="Semillas">Sal Rosada</option>
        <option value="2.35" data-category="Semillas">Sal Marina</option>
        
        <option value="7.20" data-category="Maniseria">Frutos secos</option>
        <option value="18.00" data-category="Maniseria">Maíz Tostado</option>
        <option value="7.10" data-category="Maniseria">Maní Triturado</option>
        <option value="8.00" data-category="Maniseria">Cocomani</option>
        <option value="12.60" data-category="Maniseria">Maní Salado Jumbo</option>
        <option value="6.40" data-category="Maniseria">Maní con Ajonjolí</option>
        <option value="8.00" data-category="Maniseria">Maní Pimienta Limón</option>
        <option value="8.40" data-category="Maniseria">Maní con Concha</option>
        <option value="6.40" data-category="Maniseria">Maní Garrapiñado</option>
        <option value="8.60" data-category="Maniseria">Maní con Sal</option>
        <option value="7.23" data-category="Maniseria">Maní sin Sal</option>
        <option value="12.80" data-category="Maniseria">Maní Japonés y Variantes</option>
        <option value="18.13" data-category="Maniseria">Almendras</option>
        <option value="37.56" data-category="Maniseria">Almendras Fileteadas</option>
        <option value="24.00" data-category="Maniseria">Almendras con Ajonjolí</option>
        <option value="20.16" data-category="Maniseria">Almendras con Coco</option>
        <option value="27.60" data-category="Maniseria">Almendras Garrapiñadas</option>
        <option value="30.08" data-category="Maniseria">Almendras Saladas</option>
        <option value="24.69" data-category="Maniseria">Avellanas</option>
        <option value="33.15" data-category="Maniseria">Merey</option>
        <option value="33.58" data-category="Maniseria">Pistacho</option>
        <option value="27.60" data-category="Maniseria">Nueces</option>

        <option value="0.40" data-category="Turrones">Blanco con Maní</option>
        <option value="0.40" data-category="Turrones">Acaramelado con Ajonjolí</option>
        <option value="0.40" data-category="Turrones">Acaramelado con Maní</option>
        <option value="0.40" data-category="Turrones">Mixto</option>
        <option value="2.16" data-category="Turrones">Almendras</option>
        <option value="2.50" data-category="Turrones">Avellanas</option>
        <option value="2.16" data-category="Turrones">Merey</option>
        <option value="3.83" data-category="Turrones">Pistacho</option>
        <option value="2.16" data-category="Turrones">Gourmet</option>


        <option value="5.20" data-category="Granos">Caraota Negra</option>
        <option value="3.02" data-category="Granos">Caraota Roja</option>
        <option value="3.24" data-category="Granos">Caraota Blanca</option>
        <option value="4.75" data-category="Granos">Arvejas</option>
        <option value="5.50" data-category="Granos">Lentejas</option>
        <option value="2.32" data-category="Granos">Cotufas</option>
        <option value="4.80" data-category="Granos">Garbanzos</option>
        <option value="1.62" data-category="Granos">Pico Negro</option>

        <option value="9.04" data-category="Químicos">Benzoato</option>
        <option value="6.78" data-category="Químicos">Sal de Epson</option>
        <option value="5.20" data-category="Químicos">Ácido Cítrico</option>
        <option value="3.87" data-category="Químicos">Azufre</option>
        <option value="12.56" data-category="Químicos">Ácido Bórico</option>
        <option value="7.70" data-category="Químicos">Alumbre</option>

        <option value="1.30" data-category="Esencias">JUNIOR</option>
        <option value="5.60" data-category="Esencias">SABRIMAX, PRODISABOR</option>
        <option value="3.93" data-category="Esencias">AREQUIPE, LECHE C</option>
        <option value="3.51" data-category="Esencias">PIÑA</option>
        <option value="4.80" data-category="Esencias">NATA</option>
        <option value="3.40" data-category="Esencias">BANANA</option>
        <option value="3.60" data-category="Esencias">COCO</option>
        <option value="3.40" data-category="Esencias">NARANJA</option>

        <option value="1.20" data-category="Bolsas">5X9</option>
        <option value="1.30" data-category="Bolsas">6X11</option>
        <option value="1.30" data-category="Bolsas">7X11</option>
        <option value="1.70" data-category="Bolsas">8X13</option>
        <option value="1.80" data-category="Bolsas">9X15</option>
        <option value="1.78" data-category="Bolsas">CARTON</option>

        <option value="4.68" data-category="Animales">GATARINA</option>
        <option value="2.76" data-category="Animales">PERRARINA CACHO</option>
        <option value="2.28" data-category="Animales">PERRARINA ADULTO</option>
        <option value="4.56" data-category="Animales">ALPISTE</option>
        <option value="6.00" data-category="Animales">ARENA</option>
        <option value="4.92" data-category="Animales">GATARINA EMPACADA</option>

        <option value="8.00" data-category="Colores">AMARILLO</option>
        <option value="8.66" data-category="Colores">AMARILLO LIMA</option>
        <option value="6.00" data-category="Colores">AMARILLO PAELLERO</option>
        <option value="15.22" data-category="Colores">AZUL</option>
        <option value="14.32" data-category="Colores">CHOCOLATE</option>
        <option value="17.66" data-category="Colores">ROJO</option>
        <option value="13.00" data-category="Colores">ROJO BRILLANTE</option>
        <option value="17.66" data-category="Colores">ROJO FRAMBUESA</option>
        <option value="19.66" data-category="Colores">ROSADO</option>
        <option value="14.66" data-category="Colores">UVA</option>
        <option value="9.33" data-category="Colores">VERDE</option>
        <option value="11.00" data-category="Colores">VERDE MANZANA</option>

        <option value="6.00" data-category="Repostería">Nevazúcar</option>
        <option value="8.44" data-category="Repostería">Arequipe</option>
        <option value="10.08" data-category="Repostería">Chocomalti</option>
        <option value="6.48" data-category="Repostería">Lluvia de Chocolate</option>
        <option value="14.40" data-category="Repostería">Maní Cubierto de Chocolate</option>
        <option value="6.24" data-category="Repostería">Lluvia de Colores</option>
        <option value="7.56" data-category="Repostería">Grageas</option>
        <option value="11.76" data-category="Repostería">Cerezas</option>
        <option value="8.42" data-category="Repostería">Chantilly Líquido</option>
        <option value="25.02" data-category="Repostería">Chantilly en Polvo</option>
        <option value="5.46" data-category="Repostería">Maizena</option>
        <option value="8.80" data-category="Repostería">Polvo de Hornear</option>
        <option value="20.04" data-category="Repostería">Cacao</option>
        <option value="6.36" data-category="Repostería">Levadura</option>
        <option value="12.96" data-category="Repostería">Pudin y Flan</option>
        <option value="23.84" data-category="Repostería">Gelatina sin Sabor</option>
        <option value="10.00" data-category="Repostería">Gelatina de Sabor</option>
        <option value="18.00" data-category="Repostería">Esencia de Vainilla</option>
        <option value="6.39" data-category="Repostería">Mini dandy</option>
        <option value="11.40" data-category="Repostería">Fruta Confitada</option>
        <option value="4.56" data-category="Repostería">Caramelina</option>
        <option value="3.75" data-category="Repostería">Leche evaporada</option>
        <option value="12.04" data-category="Repostería">Coco Rallado</option>
        <option value="14.28" data-category="Repostería">Perlas</option>
        <option value="19.68" data-category="Repostería">Gramilla</option>
        <option value="13.04" data-category="Repostería">CMC</option>
        <option value="3.24" data-category="Repostería">Azúcar Morena</option> 
        </select>
        <!-- Mostrar precio unitario actual -->
        <p>Precio Unitario (por kg):</p>
        <p>$<span id="priceUSD">0.00</span> / Bs <span id="priceBS">0.00</span></p>
        <label for="quantity">Cantidad (gramos):</label>
        <input type="number" id="quantity" placeholder="Ingrese gramos" min="1">
        <button onclick="addToCart()">Agregar al Carrito</button>
        <h3>Carrito de Compras</h3>
        <div id="cart"></div>
        <p><strong>Total: $<span id="totalUSD">0.00</span> / Bs <span id="totalBs">0.00</span></strong></p>
        <button onclick="confirmPurchase()" id="confirmBtn" disabled>Confirmar Compra</button>
    </div>

    <div id="invoice" class="container" style="display: none;">
        <h2>Factura</h2>
        <table>
            <thead>
                <tr>
                    <th>Producto</th>
                    <th>Cantidad (g)</th>
                    <th>Precio Unit. ($/kg)</th>
                    <th>Subtotal ($)</th>
                </tr>
            </thead>
            <tbody id="invoice-items">
            </tbody>
        </table>
        <div class="invoice-total">
            <strong>Total a Pagar: $<span id="invoice-total-usd">0.00</span> / Bs <span id="invoice-total-bs">0.00</span></strong>
        </div>
        <button onclick="printInvoice()" class="no-print">Imprimir Factura</button>
        <button onclick="goBack()" class="no-print">Volver a la Calculadora</button>
    </div>

    <script>
        let dollarRate = 0;
        let cart = [];
    
        const products = {
                "Condimentos semi": [
                    { name: "Aliño semi", price_usd_kg: 4.20 },
                    { name: "Adobo semi", price_usd_kg: 2.88 },
                    { name: "Carmencita", price_usd_kg: 4.12 },
                    { name: "Cubito semi", price_usd_kg: 2.58 },
                    { name: "Pimienta semi", price_usd_kg: 6.04 },
                    { name: "Curry semi", price_usd_kg: 3.60 },
                    { name: "Ajo semi", price_usd_kg: 4.60 },
                    { name: "Comino semi", price_usd_kg: 8.64 },
                    { name: "Sabroceador semi", price_usd_kg: 4.32 },
                    { name: "Orégano Molido", price_usd_kg: 8.80 },
                    { name: "Orégano Entero", price_usd_kg: 7.00 },
                    { name: "Combinaditos", price_usd_kg: 4.60 }
                ],
                "Condimentos Puros": [
                    { name: "Aliño puro", price_usd_kg: 7.30 },
                    { name: "Cubito puro", price_usd_kg: 7.00 },
                    { name: "Adobo puro", price_usd_kg: 6.48 },
                    { name: "Ajo Mix", price_usd_kg: 5.30 },
                    { name: "Ajo Granulado", price_usd_kg: 18.00 },
                    { name: "Cebolla", price_usd_kg: 17.04 },
                    { name: "Cúrcuma", price_usd_kg: 12.00 },
                    { name: "Jengibre", price_usd_kg: 7.56 },
                    { name: "Paprika Dulce", price_usd_kg: 15.04 },
                    { name: "Paprika Picante", price_usd_kg: 13.04 },
                    { name: "Comino puro", price_usd_kg: 20.00 },
                    { name: "Curry puro", price_usd_kg: 11.04 },
                    { name: "Pimienta pura", price_usd_kg: 26.00 },
                    { name: "Trifogón", price_usd_kg: 5.94 },
                    { name: "7 Especies", price_usd_kg: 40.00 },
                    { name: "Salchina", price_usd_kg: 5.94 },
                    { name: "Ajo Entero", price_usd_kg: 8.50 }
                ],
                "Hierbas e Infusiones": [
                    { name: "Flor de Jamaica", price_usd_kg: 18.00 },
                    { name: "Manzanilla", price_usd_kg: 21.67 },
                    { name: "Té Verde", price_usd_kg: 22.00 },
                    { name: "Hierbabuena", price_usd_kg: 15.04 },
                    { name: "Té Negro", price_usd_kg: 22.00 },
                    { name: "Sen", price_usd_kg: 14.00 },
                    { name: "Tomillo", price_usd_kg: 13.60 },
                    { name: "Menta", price_usd_kg: 11.04 },
                    { name: "Laurel", price_usd_kg: 15.00 },
                    { name: "Romero", price_usd_kg: 13.60 },
                    { name: "Albahaca", price_usd_kg: 14.00 },
                    { name: "Stevia", price_usd_kg: 19.44 },
                    { name: "Clavitos", price_usd_kg: 39.00 },
                    { name: "Canela Entera", price_usd_kg: 25.00 },
                    { name: "Canela Molida", price_usd_kg: 27.00 },
                    { name: "Anís Estrellado", price_usd_kg: 28.00 },
                    { name: "Malagueta", price_usd_kg: 19.66 },
                    { name: "Perejil", price_usd_kg: 9.28 },
                    { name: "Tilo", price_usd_kg: 55.00 },
                    { name: "Vinagre de manzana", price_usd_kg: 7.2 },
                    { name: "Aceite de coco", price_usd_kg: 28.08 },
                    { name: "Aceite de oliva", price_usd_kg: 7.13 },
                    { name: "Nuez moscada", price_usd_kg: 36.00 },
                    { name: "Panela", price_usd_kg: 0.75 }
                ],
                "Semillas": [
                    { name: "Chía", price_usd_kg: 18.40 },
                    { name: "Anís Dulce", price_usd_kg: 14.20 },
                    { name: "Linaza", price_usd_kg: 4.24 },
                    { name: "Girasol", price_usd_kg: 5.60 },
                    { name: "Auyama", price_usd_kg: 5.40 },
                    { name: "Patilla", price_usd_kg: 4.32 },
                    { name: "Fenogreco", price_usd_kg: 7.23 },
                    { name: "Ajonjolí Natural", price_usd_kg: 4.86 },
                    { name: "Ajonjolí Blanco", price_usd_kg: 12.00 },
                    { name: "Ajonjolí Negro", price_usd_kg: 16.00 },
                    { name: "Comino Entero", price_usd_kg: 18.00 },
                    { name: "Pimienta Negra Entera", price_usd_kg: 24.00 },
                    { name: "Pimienta Blanca Entera", price_usd_kg: 40.00 },
                    { name: "Pimienta Roja Entera", price_usd_kg: 50.00 },
                    { name: "Hinojo", price_usd_kg: 14.00 },
                    { name: "Quinoa", price_usd_kg: 13.04 },
                    { name: "Mostaza", price_usd_kg: 7.04 },
                    { name: "Cilantro Semilla", price_usd_kg: 14.00 },
                    { name: "Cebada", price_usd_kg: 5.55 },
                    { name: "Aceitunas", price_usd_kg: 10.74 },
                    { name: "Alcaparras", price_usd_kg: 7.50 },
                    { name: "Trigo Fino", price_usd_kg: 5.18 },
                    { name: "Avena", price_usd_kg: 2.70 },
                    { name: "Afrecho", price_usd_kg: 2.70 },
                    { name: "Achote", price_usd_kg: 17.50 },
                    { name: "Sal de Mesa", price_usd_kg: 0.50 },
                    { name: "Pasas", price_usd_kg: 8.60 },
                    { name: "Ciruela Pasas", price_usd_kg: 13.80 },
                    { name: "Sal Rosada", price_usd_kg: 10.00 },
                    { name: "Sal Marina", price_usd_kg: 2.35 }
                ],
                "Maniseria": [
                    { name: "Frutos secos", price_usd_kg: 7.20 },
                    { name: "Maíz Tostado", price_usd_kg: 18.00 },
                    { name: "Maní Triturado", price_usd_kg: 7.10 },
                    { name: "Cocomani", price_usd_kg: 8.00 },
                    { name: "Maní Salado Jumbo", price_usd_kg: 12.60 },
                    { name: "Maní con Ajonjolí", price_usd_kg: 6.40 },
                    { name: "Maní Pimienta Limón", price_usd_kg: 8.00 },
                    { name: "Maní con Concha", price_usd_kg: 8.40 },
                    { name: "Maní Garrapiñado", price_usd_kg: 6.40 },
                    { name: "Maní con Sal", price_usd_kg: 8.60 },
                    { name: "Maní sin Sal", price_usd_kg: 7.23 },
                    { name: "Maní Japonés y Variantes", price_usd_kg: 12.80 },
                    { name: "Almendras", price_usd_kg: 18.13 },
                    { name: "Almendras Fileteadas", price_usd_kg: 37.56 },
                    { name: "Almendras con Ajonjolí", price_usd_kg: 24.00 },
                    { name: "Almendras con Coco", price_usd_kg: 20.16 },
                    { name: "Almendras Garrapiñadas", price_usd_kg: 27.60 },
                    { name: "Almendras Saladas", price_usd_kg: 30.08 },
                    { name: "Avellanas", price_usd_kg: 24.69 },
                    { name: "Merey", price_usd_kg: 33.15 },
                    { name: "Pistacho", price_usd_kg: 33.58 },
                    { name: "Nueces", price_usd_kg: 27.60 }
                ],
                "Turrones": [
                    { name: "Blanco con Maní (unidad)", price_usd_kg: 0.40 },
                    { name: "Acaramelado con Ajonjolí (unidad)", price_usd_kg: 0.40 },
                    { name: "Acaramelado con Maní (unidad)", price_usd_kg: 0.40 },
                    { name: "Mixto (unidad)", price_usd_kg: 0.40 },
                    { name: "Turrón de Almendras", price_usd_kg: 2.16 },
                    { name: "Turrón de Avellanas", price_usd_kg: 2.50 },
                    { name: "Turrón de Merey", price_usd_kg: 2.16 },
                    { name: "Turrón de Pistacho", price_usd_kg: 3.83 },
                    { name: "Turrón Gourmet", price_usd_kg: 2.16 }
                ],
                "Granos": [
                    { name: "Caraota Negra", price_usd_kg: 5.20 },
                    { name: "Caraota Roja", price_usd_kg: 3.02 },
                    { name: "Caraota Blanca", price_usd_kg: 3.24 },
                    { name: "Arvejas", price_usd_kg: 4.75 },
                    { name: "Lentejas", price_usd_kg: 5.50 },
                    { name: "Cotufas", price_usd_kg: 2.32 },
                    { name: "Garbanzos", price_usd_kg: 4.80 },
                    { name: "Pico Negro", price_usd_kg: 1.62 }
                ],
                "Químicos": [
                    { name: "Benzoato de Sodio", price_usd_kg: 9.04 },
                    { name: "Sal de Epson", price_usd_kg: 6.78 },
                    { name: "Ácido Cítrico", price_usd_kg: 5.20 },
                    { name: "Azufre", price_usd_kg: 3.87 },
                    { name: "Ácido Bórico", price_usd_kg: 12.56 },
                    { name: "Alumbre", price_usd_kg: 7.70 }
                ],
                "Esencias": [
                    { name: "Esencia JUNIOR", price_usd_kg: 1.30 },
                    { name: "Esencia SABRIMAX", price_usd_kg: 5.60 },
                    { name: "Esencia PRODISABOR", price_usd_kg: 5.60 },
                    { name: "Esencia Arequipe", price_usd_kg: 3.93 },
                    { name: "Esencia Leche Condensada", price_usd_kg: 3.93 },
                    { name: "Esencia Piña", price_usd_kg: 3.51 },
                    { name: "Esencia Nata", price_usd_kg: 4.80 },
                    { name: "Esencia Banana", price_usd_kg: 3.40 },
                    { name: "Esencia Coco", price_usd_kg: 3.60 },
                    { name: "Esencia Naranja", price_usd_kg: 3.40 }
                ],
                "Bolsas": [
                    { name: "Bolsa 5x9", price_usd_kg: 1.20 },
                    { name: "Bolsa 6x11", price_usd_kg: 1.30 },
                    { name: "Bolsa 7x11", price_usd_kg: 1.30 },
                    { name: "Bolsa 8x13", price_usd_kg: 1.70 },
                    { name: "Bolsa 9x15", price_usd_kg: 1.80 },
                    { name: "Cartón", price_usd_kg: 1.78 }
                ],
                "Animales": [
                    { name: "Gatarina", price_usd_kg: 4.68 },
                    { name: "Perrarina Cachorro", price_usd_kg: 2.76 },
                    { name: "Perrarina Adulto", price_usd_kg: 2.28 },
                    { name: "Alpiste", price_usd_kg: 4.56 },
                    { name: "Arena para Gatos", price_usd_kg: 6.00 },
                    { name: "Gatarina Empacada", price_usd_kg: 4.92 }
                ],
                "Colores": [
                    { name: "Color Amarillo", price_usd_kg: 8.00 },
                    { name: "Color Amarillo Lima", price_usd_kg: 8.66 },
                    { name: "Color Amarillo Paellero", price_usd_kg: 6.00 },
                    { name: "Color Azul", price_usd_kg: 15.22 },
                    { name: "Color Chocolate", price_usd_kg: 14.32 },
                    {name: "Color Rojo", price_usd_kg: 17.66 },
                    {name: "Color Rojo Brillante", price_usd_kg: 13.00 },
                    {name: "Color Rojo Frambuesa", price_usd_kg: 17.66 },
                    {name: "Color Rosado", price_usd_kg: 19.66 },
                    {name: "Color Uva", price_usd_kg: 14.66 },
                    {name: "Color Verde", price_usd_kg: 9.33 },
                    {name: "Color Verde Manzana", price_usd_kg: 11.00 },
                    ],
                    "Repostería": [
                    { name: "Nevazúcar", price_usd_kg: 6.00 },
                        { name: "Arequipe", price_usd_kg: 8.44 },
                        { name: "Chocomalti", price_usd_kg: 10.08 },
                        { name: "Lluvia de Chocolate", price_usd_kg: 6.48 },
                        { name: "Maní Cubierto de Chocolate", price_usd_kg: 14.40 },
                        { name: "Lluvia de Colores", price_usd_kg: 6.24 },
                        { name: "Grageas", price_usd_kg: 7.56 },
                        { name: "Cerezas", price_usd_kg: 11.76 },
                        { name: "Chantilly Líquido", price_usd_kg: 8.42 },
                        { name: "Chantilly en Polvo", price_usd_kg: 25.02 },
                        { name: "Maizena", price_usd_kg: 5.46 },
                        { name: "Polvo de Hornear", price_usd_kg: 8.80 },
                        { name: "Cacao", price_usd_kg: 20.04 },
                        { name: "Levadura", price_usd_kg: 6.36 },
                        { name: "Pudin y Flan", price_usd_kg: 12.96 },
                        { name: "Gelatina sin Sabor", price_usd_kg: 23.84 },
                        { name: "Gelatina de Sabor", price_usd_kg: 10.00 },
                        { name: "Esencia de Vainilla", price_usd_kg: 18.00 },
                        { name: "Mini dandy", price_usd_kg: 6.39 },
                        { name: "Fruta Confitada", price_usd_kg: 11.40 },
                        { name: "Caramelina", price_usd_kg: 4.56 },
                        { name: "Leche evaporada", price_usd_kg: 3.75 },
                        { name: "Coco Rallado", price_usd_kg: 12.04 },
                        { name: "Perlas", price_usd_kg: 14.28 },
                        { name: "Gramilla", price_usd_kg: 19.68 },
                        { name: "CMC", price_usd_kg: 13.04 },
                        { name: "Azúcar Morena", price_usd_kg: 3.24 },
                        ],
            };
    
        async function fetchDollarRate() {
            try {
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
                const data = await response.json();
                if (data && data.rates && data.rates.VES) {
                    dollarRate = data.rates.VES;
                    document.getElementById('dollarRate').innerText = `Tasa del dólar BCV: ${dollarRate.toFixed(2)} Bs.`;
                } else {
                    document.getElementById('dollarRate').innerText = "Error al obtener la tasa del dólar.";
                }
            } catch (error) {
                document.getElementById('dollarRate').innerText = "Error al cargar la tasa del dólar.";
            }
        }
    
        function filterProducts() {
            const categorySelect = document.getElementById('category');
            const productSelect = document.getElementById('product');
            const selectedCategory = categorySelect.value;
    
            productSelect.innerHTML = '<option value="">Seleccionar Producto</option>';
            productSelect.disabled = true;
    
            if (selectedCategory && products[selectedCategory]) {
                products[selectedCategory].forEach(product => {
                    const option = document.createElement('option');
                    option.value = JSON.stringify(product);
                    option.textContent = product.name;
                    productSelect.appendChild(option);
                });
                productSelect.disabled = false;
            }
        }
    
        function calculatePrice(product, quantity) {
            let pricePerKg = product.price_usd_kg;
            let gramsNumber = parseFloat(quantity);
    
            if (gramsNumber < 250) {
                pricePerKg *= 1.6; // Aumenta un 60%
            }
    
            const priceInUSD = (pricePerKg * gramsNumber) / 1000;
            const priceInBs = priceInUSD * dollarRate;
    
            return {
                usd: priceInUSD.toFixed(2),
                bs: priceInBs.toFixed(2)
            };
        }
    
        document.addEventListener('DOMContentLoaded', function () {
            const quantityInput = document.getElementById('quantity');
            const productSelect = document.getElementById('product');
    
            function updateDisplayedPrice() {
                const selectedProductStr = productSelect.value;
                const grams = quantityInput.value;
    
                if (!selectedProductStr || !grams) return;
    
                const selectedProduct = JSON.parse(selectedProductStr);
                const finalPrice = calculatePrice(selectedProduct, grams);
    
                document.getElementById('priceUSD').innerText = `USD: ${finalPrice.usd}`;
                document.getElementById('priceBS').innerText = `Bs: ${finalPrice.bs}`;
            }
    
            quantityInput.addEventListener('input', updateDisplayedPrice);
            productSelect.addEventListener('change', updateDisplayedPrice);
        });
    
        function addToCart() {
            const productSelect = document.getElementById('product');
            const quantityInput = document.getElementById('quantity');
            const selectedProductJson = productSelect.value;
            const quantity = parseFloat(quantityInput.value);
    
            if (selectedProductJson && quantity > 0) {
                const selectedProduct = JSON.parse(selectedProductJson);
                let pricePerKg = selectedProduct.price_usd_kg;
    
                if (quantity < 250) {
                    pricePerKg *= 1.6;
                }
    
                const totalPriceUSD = (pricePerKg * quantity) / 1000;
                const totalPriceBs = totalPriceUSD * dollarRate;
    
                cart.push({
                    name: selectedProduct.name,
                    quantity: quantity,
                    price_usd_kg: selectedProduct.price_usd_kg,
                    totalPriceUSD: totalPriceUSD,
                    totalPriceBs: totalPriceBs
                });
    
                updateCartDisplay();
                quantityInput.value = '';
                document.getElementById('priceUSD').innerText = 'USD: 0';
                document.getElementById('priceBS').innerText = 'Bs: 0';
                document.getElementById('confirmBtn').disabled = false;
            } else {
                alert("Por favor, seleccione un producto e ingrese una cantidad válida.");
            }
        }
    
        function updateCartDisplay() {
            const cartDiv = document.getElementById('cart');
            const totalUSDElement = document.getElementById('totalUSD');
            const totalBsElement = document.getElementById('totalBs');
            let cartHTML = '';
            let totalUSD = 0;
            let totalBs = 0;
    
            cart.forEach((item, index) => {
                cartHTML += `
                    <div class="cart-item">
                        <span>${item.name} (${item.quantity}g)</span>
                        <span>$${item.totalPriceUSD.toFixed(2)} / Bs ${item.totalPriceBs.toFixed(2)}</span>
                        <button onclick="removeFromCart(${index})">Eliminar</button>
                    </div>
                `;
                totalUSD += item.totalPriceUSD;
                totalBs += item.totalPriceBs;
            });
    
            cartDiv.innerHTML = cartHTML;
            totalUSDElement.textContent = totalUSD.toFixed(2);
            totalBsElement.textContent = totalBs.toFixed(2);
        }
    
        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartDisplay();
            if (cart.length === 0) {
                document.getElementById('confirmBtn').disabled = true;
            }
        }
    
        function confirmPurchase() {
            if (cart.length > 0) {
                renderInvoice();
                document.getElementById('calculator').style.display = 'none';
                document.getElementById('invoice').style.display = 'block';
            } else {
                alert("El carrito está vacío. Agrega productos antes de confirmar la compra.");
            }
        }
    
        function renderInvoice() {
            const invoiceItemsBody = document.getElementById('invoice-items');
            const invoiceTotalUSD = document.getElementById('invoice-total-usd');
            const invoiceTotalBs = document.getElementById('invoice-total-bs');
            let invoiceHTML = '';
            let totalUSD = 0;
            let totalBs = 0;
    
            cart.forEach(item => {
                invoiceHTML += `
                    <tr>
                        <td>${item.name}</td>
                        <td>${item.quantity}</td>
                        <td>${item.price_usd_kg.toFixed(2)}</td>
                        <td>${item.totalPriceUSD.toFixed(2)}</td>
                    </tr>
                `;
                totalUSD += item.totalPriceUSD;
                totalBs += item.totalPriceBs;
            });
    
            invoiceItemsBody.innerHTML = invoiceHTML;
            invoiceTotalUSD.textContent = totalUSD.toFixed(2);
            invoiceTotalBs.textContent = totalBs.toFixed(2);
        }
    
        function printInvoice() {
            window.print();
        }
    
        function goBack() {
            document.getElementById('invoice').style.display = 'none';
            document.getElementById('calculator').style.display = 'block';
        }
    
        fetchDollarRate();
    </script>
</body>
</html>
